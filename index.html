<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Countdown</title>
  <link rel="stylesheet" href="style.css">
  <script src="jquery-3.2.1.min.js"></script>
  <script type="text/javascript">
  <!-- start of JavaScript
  function CountdownTimer( elemID, timeLimit, limitMessage, msgClass ) {
      this.initialize.apply( this, arguments );
  }

  CountdownTimer.prototype =  {

      /**
       * Constructor
       */
      initialize: function( elemID, timeLimit, limitMessage, msgClass ) {
          this.elem = document.getElementById( elemID );
          this.timeLimit = timeLimit;
          this.limitMessage = limitMessage;
          this.msgClass = msgClass;
      },

      /**
       * カウントダウン
       */
      countDown : function()  {
          var timer;
          var today = new Date()
          var days = Math.floor( ( this.timeLimit - today ) / ( 24 * 60 * 60 * 1000 ) );
          var hours = Math.floor( ( ( this.timeLimit - today ) % ( 24 * 60 * 60 * 1000 ) ) / ( 60 * 60 * 1000 ) );
          var mins = Math.floor( ( ( this.timeLimit - today ) % ( 24 * 60 * 60 * 1000 ) ) / ( 60 * 1000 ) ) % 60;
          var secs = Math.floor( ( ( this.timeLimit - today ) % ( 24 * 60 * 60 * 1000 ) ) / 1000 ) % 60 % 60;
          var milis = Math.floor( ( ( this.timeLimit - today ) % ( 24 * 60 * 60 * 1000 ) ) / 10 ) % 100;
          var me = this;

              if( ( this.timeLimit - today ) > 0 ){
              timer = '期限まであと<br />' + days + '日' + this.addZero( hours ) + '時間' + this.addZero( mins ) + '分'+ this.addZero( secs ) + '秒'  + this.addZero( milis ) + ' です。'
              this.elem.innerHTML = timer;
              tid = setTimeout( function() { me.countDown(); }, 10 );

              }else{
              this.elem.innerHTML = this.limitMessage;
              if( this.msgClass ) {
                  this.elem.setAttribute( 'class', this.msgClass );
              }
              return;
              }
      },

      /**
       * ゼロを付与
       */
      addZero : function( num )   {
          num = '00' + num;
          str = num.substring( num.length - 2, num.length );

          return str ;
      }
  }

  // end of JavaScript -->
  </script>
</head>
<body>
  <div class="datepicker">
    <p>期限を入力してください</p>
    <input type="date" name="date" class="date">
  </div>

  <div class="timer">
  <div class="timer_1" id="sampleA"></div>





  <script language="JavaScript" type="text/javascript">

  $('.date').change(function() {
    var date = $('.date').val();
    if (date) {
      date = new Date(date);
      var year = date.getFullYear();
      var month = date.getMonth() + 1;
      var day = date.getDate();
      console.log(date);
      cdTimer1(year, month, day);
    }
  });







  function cdTimer1(year, month, day) {

  // 設定項目 ここから---------------------------------------------
      // タグ要素のID名
      var elemID = 'sampleA';
      // 期限日を設定
      var year    =   year;           // 年
      var month   =   month;          // 月
      var day     =   day;            // 日

      // 期限終了後のメッセージ
      var limitMessage    =   '期限は終了しました。';

      var msgClass = 'msg_1';
  // 設定項目 ここまで---------------------------------------------


      var timeLimit = new Date( year, month - 1, day );
      var timer = new CountdownTimer( elemID, timeLimit, limitMessage, msgClass );
      timer.countDown();
  }
  </script>
  </div>

</body>
</html>
